<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rflsgen">
<title>Use Case 3: Recreating large landscape composition patterns • rflsgen</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Use Case 3: Recreating large landscape composition patterns">
<meta property="og:description" content="rflsgen">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rflsgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Targets.html">
    <span class="fa fa fa fa-bullseye"></span>
     
    Available targets
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/FAQ.html">
    <span class="fa fa fa fa-question-circle"></span>
     
    Frequently asked questions
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--use-cases">
    <span class="bi bi-lightbulb-fill"></span>
     
    Use cases
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--use-cases">
    <a class="dropdown-item" href="../articles/UseCase1.html">Use case 1: Fixed structure and varying spatial configurations</a>
    <a class="dropdown-item" href="../articles/UseCase2.html">Use case 2: Exploring correlations between landscape indices</a>
    <a class="dropdown-item" href="../articles/UseCase3.html">Use case 3: Recreating large landscape composition patterns</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dimitri-justeau/rflsgen/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Use Case 3: Recreating large landscape composition patterns</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dimitri-justeau/rflsgen/blob/HEAD/vignettes/UseCase3.Rmd" class="external-link"><code>vignettes/UseCase3.Rmd</code></a></small>
      <div class="d-none name"><code>UseCase3.Rmd</code></div>
    </div>

    
    
<p>In this use case, we show how rflsgen can be used to extract
landscape structures from existing landscapes, and how to recreate
neutral landscapes with the same structure, i.e. same composition
patterns.</p>
<p>We focus on the forest cover of the main island of New Caledonia, a
tropical archipelago located in the South Pacific. Using open data from
the Copernicus Global Land Service database (see <a href="#ref">References</a>), we produced a 105x105 m map with open and
closed forest cover in the main island of New Caledonia:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                    <span class="st">"copernicus_nc_grande_terre_closed_and_open_forests_200m.tif"</span>,</span>
<span>                    package <span class="op">=</span> <span class="st">"rflsgen"</span><span class="op">)</span></span>
<span><span class="va">existing_landscape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">existing_landscape</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/use_case_3_real_landscape.png"></p>
<p>To extract the landscape structure, we use the
<code>flsgen_load_structure_from_raster</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The default memory allocated to the JVM by rJava is 512mb, which will be insufficient</span></span>
<span><span class="co"># as the input raster is large (3297x2724). We increase it with the following line.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>java.parameters <span class="op">=</span> <span class="st">"-Xmx4g"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimitri-justeau.github.io/rflsgen/" class="external-link">rflsgen</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flsgen_extract_structure_from_raster.html">flsgen_extract_structure_from_raster</a></span><span class="op">(</span><span class="va">path</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                               connectivity <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p>The second argument corresponds to the focal classes raster values (0
is open forest, and 1 is closed forest), and for this use case, we use
the 8-connectivity rule.</p>
<p>We then use <code>flsgen_generate</code> to recreate a neutral
landscape from the extracted structure. We use the digital elevation
model of New Caledonia as the continuous environmental gradient.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                        <span class="st">"dem_nc_grande_terre_200m.tif"</span>,</span>
<span>                        package <span class="op">=</span> <span class="st">"rflsgen"</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flsgen_generate.html">flsgen_generate</a></span><span class="op">(</span><span class="va">struct</span>, terrain_file <span class="op">=</span> <span class="va">dem_path</span>, terrain_dependency <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                     epsg <span class="op">=</span> <span class="st">"EPSG:3163"</span>, connectivity<span class="op">=</span><span class="fl">8</span>,</span>
<span>                     resolution_x <span class="op">=</span> <span class="fl">105.4308639672429422</span>,</span>
<span>                     resolution_y <span class="op">=</span> <span class="fl">105.4037645741556588</span>,</span>
<span>                     x <span class="op">=</span> <span class="fl">159615</span>, y <span class="op">=</span> <span class="fl">467655</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/use_case_3_neutral_landscape.png"> It is
interesting to see that the generated landscape has an almost inverted
spatial distribution compared to the real landscape. This is not
surprising as the forest cover in New Caledonia is known to be
positively correlated with the elevation. If we want to generate a
neutral forest landscape also positively correlated with the elevation,
we just need to use and inverted digital elevation model</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">dem_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flsgen_generate.html">flsgen_generate</a></span><span class="op">(</span><span class="va">struct</span>, terrain_file <span class="op">=</span> <span class="va">dem</span>, terrain_dependency <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                     epsg <span class="op">=</span> <span class="st">"EPSG:3163"</span>, connectivity<span class="op">=</span><span class="fl">8</span>,</span>
<span>                     resolution_x <span class="op">=</span> <span class="fl">105.4308639672429422</span>,</span>
<span>                     resolution_y <span class="op">=</span> <span class="fl">105.4037645741556588</span>,</span>
<span>                     x <span class="op">=</span> <span class="fl">159615</span>, y <span class="op">=</span> <span class="fl">467655</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/use_case_3_neutral_landscape_inv.png"></p>
<p><strong>Note:</strong> We used geographical metadata from the
original raster to produce a landscape with the same geographical
attributes (<code>epsg</code>, <code>resolution_x</code>,
<code>resolution_y</code>, <code>x</code>, and <code>y</code>).</p>
<div class="section level2">
<h2 id="references">References <a name="ref"></a><a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Buchhorn, M., Smets, B., Bertels, L., Roo, B. D., Lesiv, M.,
Tsendbazar, N.-E., Herold, M., &amp; Fritz, S. (2020). Copernicus Global
Land Service: Land Cover 100m: collection 3: epoch 2019: Globe (V3.0.1)
[Data set]. Zenodo. <a href="https://doi.org/10.5281/ZENODO.3939050" class="external-link uri">https://doi.org/10.5281/ZENODO.3939050</a></p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dimitri Justeau-Allaire.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
